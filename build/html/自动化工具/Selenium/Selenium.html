<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>准备工作 &mdash; Liu圈圈的后宫 1.0.0 文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Cypress" href="../Cypress/index.html" />
    <link rel="prev" title="Selenium" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Liu圈圈的后宫
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">内容索引:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E4%BD%93%E7%B3%BB%E7%9F%A5%E8%AF%86/index.html">软件测试体系知识</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Python%E7%AC%94%E8%AE%B0/index.html">Python笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Linux%E7%AC%94%E8%AE%B0/index.html">Linux笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">计算机网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web%E5%AE%89%E5%85%A8/index.html">Web安全</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">数据库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E5%BE%AE%E6%9C%8D%E5%8A%A1/index.html">微服务</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E5%89%8D%E7%AB%AF%E6%B8%B8%E4%B9%90%E5%9C%BA/index.html">前端游乐场</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E5%90%8E%E7%AB%AF%E8%AE%AD%E7%BB%83%E5%9C%BA/index.html">后端训练场</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">自动化工具</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Selenium</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">准备工作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">基本用法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">获取页面基础属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">定位页面元素</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">获取页面元素属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">页面交互操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">多窗口切换</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">模拟鼠标操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">模拟键盘操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">延时等待</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">其他</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Cypress/index.html">Cypress</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DevOps%E8%90%BD%E5%9C%B0%E7%AC%94%E8%AE%B0/index.html">DevOps落地笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Git%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/index.html">Git版本管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E5%BC%80%E6%BA%90%E5%89%8D%E5%93%A8/index.html">开源前哨</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E7%9C%BC%E5%89%8D%E4%B8%80%E4%BA%AE%E7%9A%84%E9%93%BE%E6%8E%A5%E5%A4%87%E5%BF%98%E5%BD%95/index.html">眼前一亮的链接备忘录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E4%BC%9A%E5%B8%A6%E5%9B%A2%E9%98%9F%E7%9A%84%E6%8A%80%E6%9C%AF%E4%BA%BA/index.html">会带团队的技术人</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E6%96%87%E6%A1%A3%E9%9B%86/index.html">文档集</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/index.html">环境搭建</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../%E5%9C%88%E5%9C%88%E7%A2%8E%E7%A2%8E%E5%BF%B5/index.html">圈圈碎碎念</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Liu圈圈的后宫</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">自动化工具</a> &raquo;</li>
          <li><a href="index.html">Selenium</a> &raquo;</li>
      <li>准备工作</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/自动化工具/Selenium/Selenium.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>准备工作<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<ol>
<li><p>安装selenium库</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">selenium</span>
</pre></div>
</div>
</li>
<li><p>安装浏览器驱动</p>
<ul>
<li><p>手动安装</p>
<ul class="simple">
<li><p>先查看本地Chrome浏览器版本：（两种方式均可）</p>
<ul>
<li><p>在浏览器的地址栏键入Chrome://version，即可查看浏览器版本号图片</p></li>
<li><p>或者点击Chrome菜单 帮助→关于Google Chrome，查看浏览器版本号图片</p></li>
</ul>
</li>
<li><p>再选择对应版本号的驱动版本</p></li>
<li><p>下载地址：https://chromedriver.storage.googleapis.com/index.html</p></li>
<li><p>最后进行环境变量配置，将chromedriver.exe文件拖到Python的Scripts目录下</p></li>
<li><p>备注：当然也可以不这样做，但是在调用的时候指定chromedriver.exe绝对路径亦可</p></li>
</ul>
</li>
<li><p>自动安装</p>
<ul class="simple">
<li><p>自动安装需要用到第三方库webdriver_manager，先安装这个库。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">webdriver_manager.chrome</span> <span class="kn">import</span> <span class="n">ChromeDriverManager</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">ChromeDriverManager</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">())</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.baidu.com&#39;</span><span class="p">)</span>
<span class="n">search</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>
<span class="n">search</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">search</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>在上述代码中，ChromeDriverManager().install()方法就是自动安装驱动的操作，它会自动获取当前浏览器的版本并去下载对应的驱动到本地。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">======</span> <span class="n">WebDriver</span> <span class="n">manager</span> <span class="o">======</span>
<span class="n">Current</span> <span class="n">google</span><span class="o">-</span><span class="n">chrome</span> <span class="n">version</span> <span class="ow">is</span> <span class="mf">96.0</span><span class="o">.</span><span class="mi">4664</span>
<span class="n">Get</span> <span class="n">LATEST</span> <span class="n">chromedriver</span> <span class="n">version</span> <span class="k">for</span> <span class="mf">96.0</span><span class="o">.</span><span class="mi">4664</span> <span class="n">google</span><span class="o">-</span><span class="n">chrome</span>
<span class="n">There</span> <span class="ow">is</span> <span class="n">no</span> <span class="p">[</span><span class="n">win32</span><span class="p">]</span> <span class="n">chromedriver</span> <span class="k">for</span> <span class="n">browser</span>  <span class="ow">in</span> <span class="n">cache</span>
<span class="n">Trying</span> <span class="n">to</span> <span class="n">download</span> <span class="n">new</span> <span class="n">driver</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">chromedriver</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mf">96.0</span><span class="o">.</span><span class="mf">4664.45</span><span class="o">/</span><span class="n">chromedriver_win32</span><span class="o">.</span><span class="n">zip</span>
<span class="n">Driver</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="n">cache</span> <span class="p">[</span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Gdc</span>\<span class="o">.</span><span class="n">wdm</span>\<span class="n">drivers</span>\<span class="n">chromedriver</span>\<span class="n">win32</span>\<span class="mf">96.0</span><span class="o">.</span><span class="mf">4664.45</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>如果本地已经有该浏览器渠道，则会提示其已存在。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">======</span> <span class="n">WebDriver</span> <span class="n">manager</span> <span class="o">======</span>
<span class="n">Current</span> <span class="n">google</span><span class="o">-</span><span class="n">chrome</span> <span class="n">version</span> <span class="ow">is</span> <span class="mf">96.0</span><span class="o">.</span><span class="mi">4664</span>
<span class="n">Get</span> <span class="n">LATEST</span> <span class="n">driver</span> <span class="n">version</span> <span class="k">for</span> <span class="mf">96.0</span><span class="o">.</span><span class="mi">4664</span>
<span class="n">Driver</span> <span class="p">[</span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Gdc</span>\<span class="o">.</span><span class="n">wdm</span>\<span class="n">drivers</span>\<span class="n">chromedriver</span>\<span class="n">win32</span>\<span class="mf">96.0</span><span class="o">.</span><span class="mf">4664.45</span>\<span class="n">chromedriver</span><span class="o">.</span><span class="n">exe</span><span class="p">]</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">cache</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</section>
<section id="id2">
<h1>基本用法<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h1>
<ol>
<li><p>初始化浏览器对象</p>
<ul class="simple">
<li><p>在准备工作部分我们提到需要将浏览器渠道添加到环境变量或者指定绝对路径，前者可以直接初始化，后者则需要进行指定。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="c1"># 初始化浏览器为chrome浏览器</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 指定绝对路径的方式</span>
<span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Gdc\.wdm\drivers\chromedriver\win32\96.0.4664.45\chromedriver.exe&#39;</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>可以看到以上是有界面的浏览器，我们还可以初始化浏览器为无界面的浏览器。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriverx</span>
<span class="c1"># 无界面的浏览器</span>
<span class="n">option</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;headless&quot;</span><span class="p">)</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">option</span><span class="p">)</span>
<span class="c1"># 访问百度首页</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com/&#39;</span><span class="p">)</span>
<span class="c1"># 截图预览</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get_screenshot_as_file</span><span class="p">(</span><span class="s1">&#39;截图.png&#39;</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>访问页面</p>
<ul class="simple">
<li><p>进行页面访问使用的是get方法，传入参数为待访问页面的URL地址即可。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="c1"># 初始化浏览器为chrome浏览器</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 访问百度首页</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com/&#39;</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>设置浏览器大小</p>
<ul class="simple">
<li><p>set_window_size()方法可以用来设置浏览器大小（就是分辨率），而maximize_window则是设置浏览器为全屏！</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 设置浏览器大小：全屏</span>
<span class="n">browser</span><span class="o">.</span><span class="n">maximize_window</span><span class="p">()</span>   
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 设置分辨率 500*500</span>
<span class="n">browser</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 设置分辨率 1000*800</span>
<span class="n">browser</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> 
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>刷新页面</p>
<ul class="simple">
<li><p>刷新页面是我们在浏览器操作时很常用的操作，这里refresh()方法可以用来进行浏览器页面刷新。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 设置浏览器全屏</span>
<span class="n">browser</span><span class="o">.</span><span class="n">maximize_window</span><span class="p">()</span>   
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
	<span class="c1"># 刷新页面</span>
	<span class="n">browser</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>  
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;刷新页面&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;刷新失败&#39;</span><span class="p">)</span>  
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>前进后退</p>
<ul class="simple">
<li><p>前进后退也是我们在使用浏览器时非常常见的操作，这里forward()方法可以用来实现前进，back()可以用来实现后退。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 设置浏览器全屏</span>
<span class="n">browser</span><span class="o">.</span><span class="n">maximize_window</span><span class="p">()</span>   
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 打开淘宝页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.taobao.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 后退到百度页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">back</span><span class="p">()</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 前进的淘宝页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span> 
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="id3">
<h1>获取页面基础属性<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>当我们用selenium打开某个页面，有一些基础属性如网页标题、网址、浏览器名称、页面源码等信息。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span> 
<span class="c1"># 网页标题</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="c1"># 当前网址</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">current_url</span><span class="p">)</span>
<span class="c1"># 浏览器名称</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># 网页源码</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>需要注意的是，这里的页面源码我们就可以用正则表达式、Bs4、xpath以及pyquery等工具进行解析提取想要的信息了。</p></li>
</ul>
</section>
<section id="id4">
<h1>定位页面元素<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>我们在实际使用浏览器的时候，很重要的操作有输入文本、点击确定等等。对此，Selenium提供了一系列的方法来方便我们实现以上操作。常说的8种定位页面元素的操作方式，我们一一演示一下！</p></li>
</ul>
<ol>
<li><p>id定位</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>find_element_by_id()根据id属性获取，这里id属性是 kw

from selenium import webdriver
import time  
browser = webdriver.Chrome()
browser.get(r&#39;https://www.baidu.com&#39;)  
time.sleep(2)
# 在搜索框输入 python
browser.find_element_by_id(&#39;kw&#39;).send_keys(&#39;python&#39;)
time.sleep(2)
# 关闭浏览器
browser.close()
</pre></div>
</div>
</li>
<li><p>name定位</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>find_element_by_name()根据name属性获取，这里name属性是 wd
from selenium import webdriver
import time  
browser = webdriver.Chrome()
browser.get(r&#39;https://www.baidu.com&#39;)  
time.sleep(2)
# 在搜索框输入 python
browser.find_element_by_name(&#39;wd&#39;).send_keys(&#39;python&#39;)
time.sleep(2)
# 关闭浏览器
browser.close()
</pre></div>
</div>
</li>
<li><p>class定位</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>find_element_by_class_name()根据class属性获取，这里class属性是s_ipt

from selenium import webdriver
import time  
browser = webdriver.Chrome()
browser.get(r&#39;https://www.baidu.com&#39;)  
time.sleep(2)
# 在搜索框输入 python
browser.find_element_by_class_name(&#39;s_ipt&#39;).send_keys(&#39;python&#39;)
time.sleep(2)
# 关闭浏览器
browser.close()
</pre></div>
</div>
</li>
<li><p>tag定位</p>
<ul class="simple">
<li><p>我们知道HTML是通过tag来定义功能的，比如input是输入，table是表格等等。每个元素其实就是一个tag，一个tag往往用来定义一类功能，我们查看百度首页的html代码，可以看到有很多同类tag，所以其实很难通过tag去区分不同的元素。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find_element_by_tag_name</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 在搜索框输入 python</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_tag_name</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>由于存在多个input，以上代码会报错。</p></li>
</ul>
</li>
<li><p>link定位</p>
<ul class="simple">
<li><p>这种方法顾名思义就是用来定位文本链接的，比如百度首页上方的分类模块链接。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find_element_by_link_text</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 点击新闻 链接</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;新闻&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器全部页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>partial定位</p>
<ul class="simple">
<li><p>有时候一个超链接的文本很长，我们如果全部输入，既麻烦，又显得代码很不美观，这时候我们就可以只截取一部分字符串，用这种方法模糊匹配了。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find_element_by_partial_link_text</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 点击新闻 链接</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_partial_link_text</span><span class="p">(</span><span class="s1">&#39;闻&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器全部页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>xpath定位</p>
<ul class="simple">
<li><p>前面介绍的几种定位方法都是在理想状态下，有一定使用范围的，那就是：在当前页面中，每个元素都有一个唯一的id或name或class或超链接文本的属性，那么我们就可以通过这个唯一的属性值来定位他们。</p></li>
<li><p>但是在实际工作中并非有这么美好，那么这个时候我们就只能通过xpath或者css来定位了。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find_element_by_xpath</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 在搜索框输入 python</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//*[@id=&#39;kw&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>css定位</p>
<ul class="simple">
<li><p>这种方法相对xpath要简洁些，定位速度也要快些。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find_element_by_css_selector</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 在搜索框输入 python</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s1">&#39;#kw&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>find_element的By定位</p>
<ul class="simple">
<li><p>除了上述的8种定位方法，Selenium还提供了一个通用的方法find_element()，这个方法有两个参数：定位方式和定位值。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># 使用前先导入By类
from selenium.webdriver.common.by import By
以上的操作可以等同于以下：

browser.find_element(By.ID,&#39;kw&#39;)
browser.find_element(By.NAME,&#39;wd&#39;)
browser.find_element(By.CLASS_NAME,&#39;s_ipt&#39;)
browser.find_element(By.TAG_NAME,&#39;input&#39;)
browser.find_element(By.LINK_TEXT,&#39;新闻&#39;)
browser.find_element(By.PARTIAL_LINK_TEXT,&#39;闻&#39;)
browser.find_element(By.XPATH,&#39;//*[@id=&quot;kw&quot;]&#39;)
browser.find_element(By.CSS_SELECTOR,&#39;#kw&#39;)
</pre></div>
</div>
</li>
<li><p>多个元素</p>
<ul class="simple">
<li><p>如果定位的目标元素在网页中不止一个，那么则需要用到find_elements，得到的结果会是列表形式。简单来说，就是element后面多了复数标识s，其他操作一致。</p></li>
</ul>
</li>
</ol>
</section>
<section id="id5">
<h1>获取页面元素属性<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>既然我们有很多方式来定位页面的元素，那么接下来就可以考虑获取以下元素的属性了，尤其是用Selenium进行网络爬虫的时候。</p></li>
<li><p>get_attribute获取属性</p></li>
<li><p>以百度首页的logo为例，获取logo相关属性</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">img</span> <span class="n">hidefocus</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;s_lg_img&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;index-logo-src&quot;</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;//www.baidu.com/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png&quot;</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;270&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;129&quot;</span> <span class="n">onerror</span><span class="o">=</span><span class="s2">&quot;this.src=&#39;//www.baidu.com/img/flexible/logo/pc/index.png&#39;;this.onerror=null;&quot;</span> <span class="n">usemap</span><span class="o">=</span><span class="s2">&quot;#mp&quot;</span><span class="o">&gt;</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">logo</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;index-logo-src&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">))</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>获取文本，用的是text属性，直接调用即可</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">logo</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s1">&#39;#hotsearch-content-wrapper &gt; li:nth-child(1) &gt; a&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>除了属性和文本值外，还有id、位置、标签名和大小等属性。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">logo</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;index-logo-src&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">tag_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">logo</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id6">
<h1>页面交互操作<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h1>
<ul>
<li><p>页面交互就是在浏览器的各种操作，比如上面演示过的输入文本、点击链接等等，还有像清除文本、回车确认、单选框与多选框选中等。</p></li>
<li><p>输入文本</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send_keys</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位搜索框</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;s_ipt&#39;</span><span class="p">)</span>
<span class="c1"># 输入python</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>点击</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">click</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 选中新闻按钮</span>
<span class="n">click</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;新闻&#39;</span><span class="p">)</span>
<span class="c1"># 点击之</span>
<span class="n">click</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器全部页面</span>
<span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>清除文本</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clear</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位搜索框</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;s_ipt&#39;</span><span class="p">)</span>
<span class="c1"># 输入python</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 清除python</span>
<span class="nb">input</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>回车确认</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">submit</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位搜索框</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;s_ipt&#39;</span><span class="p">)</span>
<span class="c1"># 输入python</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 回车查询</span>
<span class="nb">input</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>单选</p>
<ul class="simple">
<li><p>单选比较好操作，先定位需要单选的某个元素，然后点击一下即可。</p></li>
</ul>
</li>
<li><p>多选</p>
<ul class="simple">
<li><p>多选也比较容易，依次定位需要选择的元素，点击即可。</p></li>
</ul>
</li>
<li><p>下拉框</p>
<ul class="simple">
<li><p>下拉框的操作相对复杂一些，需要用到Select模块。</p></li>
<li><p>from selenium.webdriver.support.select import Select</p></li>
<li><p>在select模块中有以下定位方法</p>
<ul>
<li><p>1、三种选择某一选项项的方法</p>
<ul>
<li><p>select_by_index()           # 通过索引定位；注意：index索引是从“0”开始。</p></li>
<li><p>select_by_value()           # 通过value值定位，value标签的属性值。</p></li>
<li><p>select_by_visible_text()    # 通过文本值定位，即显示在下拉框的值。</p></li>
</ul>
</li>
<li><p>2、三种返回options信息的方法</p>
<ul>
<li><p>options                     # 返回select元素所有的options</p></li>
<li><p>all_selected_options        # 返回select元素中所有已选中的选项</p></li>
<li><p>first_selected_options      # 返回select元素中选中的第一个选项</p></li>
</ul>
</li>
<li><p>3、四种取消选中项的方法</p>
<ul>
<li><p>deselect_all                # 取消全部的已选择项</p></li>
<li><p>deselect_by_index           # 取消已选中的索引项</p></li>
<li><p>deselect_by_value           # 取消已选中的value值</p></li>
<li><p>deselect_by_visible_text    # 取消已选中的文本值</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id7">
<h1>多窗口切换<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h1>
<ul>
<li><p>比如同一个页面的不同子页面的节点元素获取操作，不同选项卡之间的切换以及不同浏览器窗口之间的切换操作等等。</p></li>
<li><p>Frame切换</p>
<ul class="simple">
<li><p>Selenium打开一个页面之后，默认是在父页面进行操作，此时如果这个页面还有子页面，想要获取子页面的节点元素信息则需要切换到子页面进行擦走，这时候switch_to.frame()就来了。如果想回到父页面，用switch_to.parent_frame()即可。</p></li>
</ul>
</li>
<li><p>选项卡切换</p>
<ul class="simple">
<li><p>我们在访问网页的时候会打开很多个页面，在Selenium中提供了一些方法方便我们对这些页面进行操作。</p></li>
<li><p>current_window_handle：获取当前窗口的句柄。</p></li>
<li><p>window_handles：返回当前浏览器的所有窗口的句柄。</p></li>
<li><p>switch_to_window()：用于切换到对应的窗口。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>	
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>	
<span class="c1"># 打开百度</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.baidu.com&#39;</span><span class="p">)</span>
<span class="c1"># 新建一个选项卡</span>
<span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;window.open()&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">)</span>
<span class="c1"># 跳转到第二个选项卡并打开知乎</span>
<span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.zhihu.com&#39;</span><span class="p">)</span>
<span class="c1"># 回到第一个选项卡并打开淘宝（原来的百度页面改为了淘宝）</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.taobao.com&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id8">
<h1>模拟鼠标操作<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>既然是模拟浏览器操作，自然也就需要能模拟鼠标的一些操作了，这里需要导入ActionChains 类。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
</pre></div>
</div>
<ul>
<li><p>左键，这个其实就是页面交互操作中的点击click()操作。</p></li>
<li><p>右键</p>
<ul class="simple">
<li><p>context_click()</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位到要右击的元素，这里选的新闻链接</span>
<span class="n">right_click</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;新闻&#39;</span><span class="p">)</span>
<span class="c1"># 执行鼠标右键操作</span>
<span class="n">ActionChains</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span><span class="o">.</span><span class="n">context_click</span><span class="p">(</span><span class="n">right_click</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>ActionChains(browser)：调用ActionChains()类，并将浏览器驱动browser作为参数传入</p></li>
<li><p>context_click(right_click)：模拟鼠标双击，需要传入指定元素定位作为参数</p></li>
<li><p>perform()：执行ActionChains()中储存的所有操作，可以看做是执行之前一系列的操作</p></li>
</ul>
</li>
<li><p>双击</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double_click</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位到要双击的元素</span>
<span class="n">double_click</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s1">&#39;#bottom_layer &gt; div &gt; p:nth-child(8) &gt; span&#39;</span><span class="p">)</span>
<span class="c1"># 双击</span>
<span class="n">ActionChains</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span><span class="o">.</span><span class="n">double_click</span><span class="p">(</span><span class="n">double_click</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>拖拽</p>
<ul class="simple">
<li><p>drag_and_drop(source,target)，开始位置和结束位置需要被指定，这个常用于滑块类验证码的操作之类。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&#39;</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s1">&#39;iframeResult&#39;</span><span class="p">)</span>
<span class="c1"># 开始位置</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s2">&quot;#draggable&quot;</span><span class="p">)</span>
<span class="c1"># 结束位置</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s2">&quot;#droppable&quot;</span><span class="p">)</span>
<span class="c1"># 执行元素的拖放操作</span>
<span class="n">actions</span> <span class="o">=</span> <span class="n">ActionChains</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span>
<span class="n">actions</span><span class="o">.</span><span class="n">drag_and_drop</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="n">actions</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
<span class="c1"># 拖拽</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>悬停</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">move_to_element</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.baidu.com&#39;</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位悬停的位置</span>
<span class="n">move</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s2">&quot;#form &gt; span.bg.s_ipt_wr.new-pmd.quickdelete-wrap &gt; span.soutu-btn&quot;</span><span class="p">)</span>
<span class="c1"># 悬停操作</span>
<span class="n">ActionChains</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">move</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id9">
<h1>模拟键盘操作<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>selenium中的Keys()类提供了大部分的键盘操作方法，通过send_keys()方法来模拟键盘上的按键。</p></li>
<li><p>引入Keys类</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>from selenium.webdriver.common.keys import Keys
常见的键盘操作
send_keys(Keys.BACK_SPACE)：删除键(BackSpace)
send_keys(Keys.SPACE)：空格键(Space)
send_keys(Keys.TAB)：制表键(TAB)
send_keys(Keys.ESCAPE)：回退键(ESCAPE)
send_keys(Keys.ENTER)：回车键(ENTER)
send_keys(Keys.CONTRL,&#39;a&#39;)：全选(Ctrl+A)
send_keys(Keys.CONTRL,&#39;c&#39;)：复制(Ctrl+C)
send_keys(Keys.CONTRL,&#39;x&#39;)：剪切(Ctrl+X)
send_keys(Keys.CONTRL,&#39;v&#39;)：粘贴(Ctrl+V)
send_keys(Keys.F1)：键盘F1
.....

send_keys(Keys.F12)：键盘F12
</pre></div>
</div>
<ul class="simple">
<li><p>定位需要操作的元素，然后操作即可！</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.baidu.com&#39;</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 定位搜索框</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;s_ipt&#39;</span><span class="p">)</span>
<span class="c1"># 输入python</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 回车</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id10">
<h1>延时等待<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>如果遇到使用ajax加载的网页，页面元素可能不是同时加载出来的，这个时候尝试在get方法执行完成时获取网页源代码可能并非浏览器完全加载完成的页面。所以，这种情况下需要设置延时等待一定时间，确保全部节点都加载出来。</p></li>
<li><p>三种方式可以来玩玩：强制等待、隐式等待和显式等待</p></li>
</ul>
<ol>
<li><p>强制等待</p>
<ul class="simple">
<li><p>就很简单了，直接time.sleep(n)强制等待n秒，在执行get方法之后执行。</p></li>
</ul>
</li>
<li><p>隐式等待</p>
<ul class="simple">
<li><p>implicitly_wait()设置等待时间，如果到时间有元素节点没有加载出来，就会抛出异常。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 隐式等待，等待时间10秒</span>
<span class="n">browser</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">current_url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>显式等待</p>
<ul class="simple">
<li><p>设置一个等待时间和一个条件，在规定时间内，每隔一段时间查看下条件是否成立，如果成立那么程序就继续执行，否则就抛出一个超时异常。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.wait</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">import</span> <span class="nn">time</span>	
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">)</span>
<span class="c1"># 设置等待时间10s</span>
<span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">browser</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># 设置判断条件：等待id=&#39;kw&#39;的元素加载完成</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;kw&#39;</span><span class="p">)))</span>
<span class="c1"># 在关键词输入：关键词</span>
<span class="nb">input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;Python&#39;</span><span class="p">)</span>
<span class="c1"># 关闭浏览器</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>WebDriverWait的参数说明</p>
<ul>
<li><p>WebDriverWait(driver,timeout,poll_frequency=0.5,ignored_exceptions=None)</p></li>
<li><p>driver: 浏览器驱动</p></li>
<li><p>timeout: 超时时间，等待的最长时间（同时要考虑隐性等待时间）</p></li>
<li><p>poll_frequency: 每次检测的间隔时间，默认是0.5秒</p></li>
<li><p>ignored_exceptions:超时后的异常信息，默认情况下抛出NoSuchElementException异常</p></li>
</ul>
</li>
<li><p>until(method,message=’’)</p>
<ul>
<li><p>method: 在等待期间，每隔一段时间调用这个传入的方法，直到返回值不是False</p></li>
<li><p>message: 如果超时，抛出TimeoutException，将message传入异常</p></li>
</ul>
</li>
<li><p>until_not(method,message=’’)</p>
<ul>
<li><p>until_not 与until相反，until是当某元素出现或什么条件成立则继续执行，until_not是当某元素消失或什么条件不成立则继续执行，参数也相同。</p></li>
</ul>
</li>
<li><p>其他等待条件</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="c1"># 判断标题是否和预期的一致</span>
<span class="n">title_is</span>
<span class="c1"># 判断标题中是否包含预期的字符串</span>
<span class="n">title_contains</span>
<span class="c1"># 判断指定元素是否加载出来</span>
<span class="n">presence_of_element_located</span>
<span class="c1"># 判断所有元素是否加载完成</span>
<span class="n">presence_of_all_elements_located</span>
<span class="c1"># 判断某个元素是否可见. 可见代表元素非隐藏，并且元素的宽和高都不等于0，传入参数是元组类型的locator</span>
<span class="n">visibility_of_element_located</span>
<span class="c1"># 判断元素是否可见，传入参数是定位后的元素WebElement</span>
<span class="n">visibility_of</span>
<span class="c1"># 判断某个元素是否不可见，或是否不存在于DOM树</span>
<span class="n">invisibility_of_element_located</span>
<span class="c1"># 判断元素的 text 是否包含预期字符串</span>
<span class="n">text_to_be_present_in_element</span>
<span class="c1"># 判断元素的 value 是否包含预期字符串</span>
<span class="n">text_to_be_present_in_element_value</span>
<span class="c1">#判断frame是否可切入，可传入locator元组或者直接传入定位方式：id、name、index或WebElement</span>
<span class="n">frame_to_be_available_and_switch_to_it</span>
<span class="c1">#判断是否有alert出现</span>
<span class="n">alert_is_present</span>
<span class="c1">#判断元素是否可点击</span>
<span class="n">element_to_be_clickable</span>
<span class="c1"># 判断元素是否被选中,一般用在下拉列表，传入WebElement对象</span>
<span class="n">element_to_be_selected</span>
<span class="c1"># 判断元素是否被选中</span>
<span class="n">element_located_to_be_selected</span>
<span class="c1"># 判断元素的选中状态是否和预期一致，传入参数：定位后的元素，相等返回True，否则返回False</span>
<span class="n">element_selection_state_to_be</span>
<span class="c1"># 判断元素的选中状态是否和预期一致，传入参数：元素的定位，相等返回True，否则返回False</span>
<span class="n">element_located_selection_state_to_be</span>
<span class="c1">#判断一个元素是否仍在DOM中，传入WebElement对象，可以判断页面是否刷新了</span>
<span class="n">staleness_of</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="id11">
<h1>其他<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h1>
<ol>
<li><p>还有一些操作，比如下拉进度条，模拟javaScript，使用execute_script方法来实现</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 知乎发现页</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.zhihu.com/explore&#39;</span><span class="p">)</span>
<span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;window.scrollTo(0, document.body.scrollHeight)&#39;</span><span class="p">)</span>
<span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;alert(&quot;To Bottom&quot;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>在selenium使用过程中，还可以很方便对Cookie进行获取、添加与删除等操作。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="c1"># 知乎发现页</span>
<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.zhihu.com/explore&#39;</span><span class="p">)</span>
<span class="c1"># 获取cookie</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cookies的值：</span><span class="si">{</span><span class="n">browser</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># 添加cookie</span>
<span class="n">browser</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;才哥&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="s1">&#39;帅哥&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;添加后Cookies的值：</span><span class="si">{</span><span class="n">browser</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># 删除cookie</span>
<span class="n">browser</span><span class="o">.</span><span class="n">delete_all_cookies</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;删除后Cookies的值：</span><span class="si">{</span><span class="n">browser</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>输出：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Cookies的值：[{&#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;Hm_lpvt_98beee57fd2ef70ccdd5ca52b9740c49&#39;, &#39;path&#39;: &#39;/&#39;, &#39;secure&#39;: False, &#39;value&#39;: &#39;1640537860&#39;}, {&#39;domain&#39;: &#39;.zhihu.com&#39;, ...]
添加后Cookies的值：[{&#39;domain&#39;: &#39;www.zhihu.com&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;才哥&#39;, &#39;path&#39;: &#39;/&#39;, &#39;secure&#39;: True, &#39;value&#39;: &#39;帅哥&#39;}, {&#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;Hm_lpvt_98beee57fd2ef70ccdd5ca52b9740c49&#39;, &#39;path&#39;: &#39;/&#39;, &#39;secure&#39;: False, &#39;value&#39;: &#39;1640537860&#39;}, {&#39;domain&#39;: &#39;.zhihu.com&#39;,...]
删除后Cookies的值：[]
</pre></div>
</div>
</li>
<li><p>反屏蔽</p>
<ul class="simple">
<li><p>此处backlog！！！</p></li>
</ul>
</li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Selenium" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Cypress/index.html" class="btn btn-neutral float-right" title="Cypress" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Liulinyuan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>